{
  "summary": "Models segmented copy ratios from denoised copy ratios and segmented minor-allele fractions from allelic counts",
  "arguments": [
    {
      "summary": "Input files containing allelic counts (output of CollectAllelicCounts).  If multiple samples are specified, multisample kernel segmentation will be performed but modeling will be skipped; sample order must match that of input denoised-copy-ratios files.",
      "name": "--allelic-counts",
      "synonyms": "NA",
      "type": "List[File]",
      "required": "no",
      "fulltext": "",
      "defaultValue": "[]",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "read one or more arguments files and add them to the command line",
      "name": "--arguments_file",
      "synonyms": "NA",
      "type": "List[File]",
      "required": "no",
      "fulltext": "",
      "defaultValue": "[]",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Input files containing denoised copy ratios (output of DenoiseReadCounts).  If multiple samples are specified, multisample kernel segmentation will be performed but modeling will be skipped; sample order must match that of input allelic-counts files.",
      "name": "--denoised-copy-ratios",
      "synonyms": "NA",
      "type": "List[File]",
      "required": "no",
      "fulltext": "",
      "defaultValue": "[]",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "A configuration file to use with the GATK.",
      "name": "--gatk-config-file",
      "synonyms": "NA",
      "type": "String",
      "required": "no",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "If the GCS bucket channel errors out, how many times it will attempt to re-initiate the connection",
      "name": "--gcs-max-retries",
      "synonyms": "-gcs-retries",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "20",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Project to bill when accessing \"requester pays\" buckets. If unset, these buckets cannot be accessed.  User must have storage.buckets.get permission on the bucket being accessed.",
      "name": "--gcs-project-for-requester-pays",
      "synonyms": "NA",
      "type": "String",
      "required": "no",
      "fulltext": "",
      "defaultValue": "\"\"",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Maximum base-error rate for genotyping and filtering homozygous allelic counts, if available.  The likelihood for an allelic count to be generated from a homozygous site will be integrated from zero base-error rate up to this value.  Decreasing this value will increase the number of sites assumed to be heterozygous for modeling.",
      "name": "--genotyping-base-error-rate",
      "synonyms": "NA",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "0.05",
      "minValue": "0.0",
      "maxValue": "1.0",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Log-ratio threshold for genotyping and filtering homozygous allelic counts, if available.  Increasing this value will increase the number of sites assumed to be heterozygous for modeling.",
      "name": "--genotyping-homozygous-log-ratio-threshold",
      "synonyms": "NA",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "-10.0",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "display the help message",
      "name": "--help",
      "synonyms": "-h",
      "type": "boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Dimension of the kernel approximation.  A subsample containing this number of data points will be used to construct the approximation for each chromosome.  If the total number of data points in a chromosome is greater than this number, then all data points in the chromosome will be used.  Time complexity scales quadratically and space complexity scales linearly with this parameter.",
      "name": "--kernel-approximation-dimension",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "100",
      "minValue": "1.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Relative scaling S of the kernel K_AF for allele-fraction segmentation to the kernel K_CR for copy-ratio segmentation.  If multidimensional segmentation is performed, the total kernel used will be K_CR + S * K_AF.",
      "name": "--kernel-scaling-allele-fraction",
      "synonyms": "NA",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "1.0",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Variance of Gaussian kernel for allele-fraction segmentation, if performed.  If zero, a linear kernel will be used.",
      "name": "--kernel-variance-allele-fraction",
      "synonyms": "NA",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "0.025",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Variance of Gaussian kernel for copy-ratio segmentation, if performed.  If zero, a linear kernel will be used.",
      "name": "--kernel-variance-copy-ratio",
      "synonyms": "NA",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "0.0",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Maximum number of segments allowed per chromosome.",
      "name": "--maximum-number-of-segments-per-chromosome",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "1000",
      "minValue": "1.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Maximum number of iterations allowed for segmentation smoothing.",
      "name": "--maximum-number-of-smoothing-iterations",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "25",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Minimum total count for filtering allelic counts in the case sample, if available.  The default value of zero is appropriate for matched-normal mode; increase to an appropriate value for case-only mode.",
      "name": "--minimum-total-allele-count-case",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "0",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Minimum total count for filtering allelic counts in the matched-normal sample, if available.",
      "name": "--minimum-total-allele-count-normal",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "30",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Alpha hyperparameter for the 4-parameter beta-distribution prior on segment minor-allele fraction. The prior for the minor-allele fraction f in each segment is assumed to be Beta(alpha, 1, 0, 1/2). Increasing this hyperparameter will reduce the effect of reference bias at the expense of sensitivity.",
      "name": "--minor-allele-fraction-prior-alpha",
      "synonyms": "NA",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "25.0",
      "minValue": "1.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Input file containing allelic counts for a matched normal (output of CollectAllelicCounts).  If specified, these allelic counts will be used to perform genotyping but will not be used for multisample kernel segmentation; if the latter is desired, additionally specify this file as one of the arguments to --allelic-counts.",
      "name": "--normal-allelic-counts",
      "synonyms": "NA",
      "type": "File",
      "required": "no",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Number of burn-in samples to discard for allele-fraction model.",
      "name": "--number-of-burn-in-samples-allele-fraction",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "50",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Number of burn-in samples to discard for copy-ratio model.",
      "name": "--number-of-burn-in-samples-copy-ratio",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "50",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Factor A for the penalty on the number of changepoints per chromosome for segmentation.  Adds a penalty of the form A * C * [1 + log (N / C)], where C is the number of changepoints in the chromosome and N is the number of data points in the chromosome, to the cost function for each chromosome.  Must be non-negative.",
      "name": "--number-of-changepoints-penalty-factor",
      "synonyms": "NA",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "1.0",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Total number of MCMC samples for allele-fraction model.",
      "name": "--number-of-samples-allele-fraction",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "100",
      "minValue": "1.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Total number of MCMC samples for copy-ratio model.",
      "name": "--number-of-samples-copy-ratio",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "100",
      "minValue": "1.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Number of segmentation-smoothing iterations per MCMC model refit. (Increasing this will decrease runtime, but the final number of segments may be higher. Setting this to 0 will completely disable model refitting between iterations.)",
      "name": "--number-of-smoothing-iterations-per-fit",
      "synonyms": "NA",
      "type": "int",
      "required": "no",
      "fulltext": "",
      "defaultValue": "0",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Output directory.  This will be created if it does not exist.",
      "name": "--output",
      "synonyms": "-O",
      "type": "File",
      "required": "yes",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "required",
      "options": []
    },
    {
      "summary": "Prefix for output filenames.",
      "name": "--output-prefix",
      "synonyms": "NA",
      "type": "String",
      "required": "yes",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "required",
      "options": []
    },
    {
      "summary": "Whether to suppress job-summary info on System.err.",
      "name": "--QUIET",
      "synonyms": "NA",
      "type": "Boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Input Picard interval-list file specifying segments.  If provided, kernel segmentation will be skipped.",
      "name": "--segments",
      "synonyms": "NA",
      "type": "File",
      "required": "no",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "advanced",
      "options": []
    },
    {
      "summary": "display hidden arguments",
      "name": "--showHidden",
      "synonyms": "-showHidden",
      "type": "boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "advanced",
      "options": []
    },
    {
      "summary": "Number of 10% equal-tailed credible-interval widths to use for allele-fraction segmentation smoothing.",
      "name": "--smoothing-credible-interval-threshold-allele-fraction",
      "synonyms": "NA",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "2.0",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Number of 10% equal-tailed credible-interval widths to use for copy-ratio segmentation smoothing.",
      "name": "--smoothing-credible-interval-threshold-copy-ratio",
      "synonyms": "NA",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "2.0",
      "minValue": "0.0",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Temp directory to use.",
      "name": "--tmp-dir",
      "synonyms": "NA",
      "type": "GATKPath",
      "required": "no",
      "fulltext": "",
      "defaultValue": "null",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Whether to use the JdkDeflater (as opposed to IntelDeflater)",
      "name": "--use-jdk-deflater",
      "synonyms": "-jdk-deflater",
      "type": "boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Whether to use the JdkInflater (as opposed to IntelInflater)",
      "name": "--use-jdk-inflater",
      "synonyms": "-jdk-inflater",
      "type": "boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": []
    },
    {
      "summary": "Control verbosity of logging.",
      "name": "--verbosity",
      "synonyms": "-verbosity",
      "type": "LogLevel",
      "required": "no",
      "fulltext": "",
      "defaultValue": "INFO",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "common",
      "options": [
        {
          "summary": "",
          "name": "ERROR"
        },
        {
          "summary": "",
          "name": "WARNING"
        },
        {
          "summary": "",
          "name": "INFO"
        },
        {
          "summary": "",
          "name": "DEBUG"
        }
      ]
    },
    {
      "summary": "display the version number for this tool",
      "name": "--version",
      "synonyms": "NA",
      "type": "boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "false",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    },
    {
      "summary": "Window sizes to use for calculating local changepoint costs.  For each window size, the cost for each data point to be a changepoint will be calculated assuming that the point demarcates two adjacent segments of that size.  Including small (large) window sizes will increase sensitivity to small (large) events.  Duplicate values will be ignored.",
      "name": "--window-size",
      "synonyms": "NA",
      "type": "List[Integer]",
      "required": "no",
      "fulltext": "",
      "defaultValue": "[8, 16, 32, 64, 128, 256]",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "kind": "optional",
      "options": []
    }
  ],
  "description": "Models segmented copy ratios from denoised copy ratios and segmented minor-allele fractions from allelic counts.\n\n \u003cp\u003e\n     Possible data inputs are: 1) denoised copy ratios for the case sample, 2) allelic counts for the case sample,\n     and 3) allelic counts for a matched-normal sample.  All available inputs will be used to to perform\n     segmentation and model inference.\n \u003c/p\u003e\n\n \u003ch4\u003eGenotyping step\u003c/h4\u003e\n\n \u003cp\u003e\n     If allelic counts are available, the first step in the inference process is to genotype heterozygous sites,\n     as the allelic counts at these sites will subsequently be modeled to infer segmented minor-allele fraction.\n     We perform a relatively simple and naive genotyping based on the allele counts (i.e., pileups), which is\n     controlled by a small number of parameters (minimum-total-allele-count,\n     genotyping-homozygous-log-ratio-threshold, and genotyping-homozygous-log-ratio-threshold).\n     If the matched normal is available, its allelic counts will be used to genotype the sites, and\n     we will simply assume these genotypes are the same in the case sample.  (This can be critical, for example,\n     for determining sites with loss of heterozygosity in high purity case samples; such sites will be genotyped as\n     homozygous if the matched-normal sample is not available.)\n \u003c/p\u003e\n\n \u003ch4\u003eSegmentation step\u003c/h4\u003e\n\n \u003cp\u003e\n     Next, we segment, if available, the denoised copy ratios and the alternate-allele fractions at the\n     genotyped heterozygous sites.  This is done using kernel segmentation (see KernelSegmenter).\n     Various segmentation parameters control the sensitivity of the segmentation and should be selected\n     appropriately for each analysis.  If a Picard interval-list file has been specified by the segments\n     argument, the corresponding segmentation will be used instead and this step will be skipped.\n \u003c/p\u003e\n\n \u003cp\u003e\n     If both copy ratios and allele fractions are available, we perform segmentation using a combined kernel\n     that is sensitive to changes that occur not only in either of the two but also in both.  However, in this case,\n     we simply discard all allele fractions at sites that lie outside of the available copy-ratio intervals\n     (rather than imputing the missing copy-ratio data); these sites are filtered out during the genotyping step\n     discussed above.  This can have implications for analyses involving the sex chromosomes;\n     see comments in CreateReadCountPanelOfNormals.\n \u003c/p\u003e\n\n \u003ch4\u003eModeling step\u003c/h4\u003e\n\n \u003cp\u003e\n     After segmentation is complete, we run Markov-chain Monte Carlo (MCMC) to determine posteriors for\n     segmented models for the log2 copy ratio and the minor-allele fraction; see CopyRatioModeller\n     and AlleleFractionModeller, respectively.  After the first run of MCMC is complete,\n     smoothing of the segmented posteriors is performed by merging adjacent segments whose posterior\n     credible intervals sufficiently overlap according to specified segmentation-smoothing parameters.\n     Then, additional rounds of segmentation smoothing (with intermediate MCMC optionally performed in between rounds)\n     are performed until convergence, at which point a final round of MCMC is performed.\n \u003c/p\u003e\n\n \u003ch3\u003eInputs\u003c/h3\u003e\n\n \u003cul\u003e\n     \u003cli\u003e\n         (Optional) Denoised-copy-ratios file from DenoiseReadCounts.\n         If allelic counts are not provided, then this is required.\n     \u003c/li\u003e\n     \u003cli\u003e\n         (Optional) Allelic-counts file from CollectAllelicCounts.\n         If denoised copy ratios are not provided, then this is required.\n     \u003c/li\u003e\n     \u003cli\u003e\n         (Optional) Matched-normal allelic-counts file from CollectAllelicCounts.\n         This can only be provided if allelic counts for the case sample are also provided.\n     \u003c/li\u003e\n     \u003cli\u003e\n         (Optional, Advanced) Picard interval-list file containing a multisample segmentation output by\n         a previous run of ModelSegments in multisample mode.\n         Segmentation step will not be performed.\n         See description of multisample mode below.\n     \u003c/li\u003e\n     \u003cli\u003e\n         Output prefix.\n         This is used as the basename for output files.\n     \u003c/li\u003e\n     \u003cli\u003e\n         Output directory.\n         This will be created if it does not exist.\n     \u003c/li\u003e\n \u003c/ul\u003e\n\n \u003ch3\u003eOutputs\u003c/h3\u003e\n\n \u003cul\u003e\n     \u003cli\u003e\n         Modeled-segments .modelBegin.seg and .modelFinal.seg files.\n         These are tab-separated values (TSV) files with a SAM-style header containing a read group sample name, a sequence dictionary,\n         a row specifying the column headers contained in ModeledSegmentCollection.ModeledSegmentTableColumn,\n         and the corresponding entry rows.\n         The initial result before segmentation smoothing is output to the .modelBegin.seg file\n         and the final result after segmentation smoothing is output to the .modelFinal.seg file.\n     \u003c/li\u003e\n     \u003cli\u003e\n         Allele-fraction-model global-parameter files (.modelBegin.af.param and .modelFinal.af.param).\n         These are tab-separated values (TSV) files with a SAM-style header containing a read group sample name,\n         a row specifying the column headers contained in ParameterDecileCollection.ParameterTableColumn,\n         and the corresponding entry rows.\n         The initial result before segmentation smoothing is output to the .modelBegin.af.param file\n         and the final result after segmentation smoothing is output to the .modelFinal.af.param file.\n     \u003c/li\u003e\n     \u003cli\u003e\n         Copy-ratio-model global-parameter files (.modelBegin.cr.param and .modelFinal.cr.param).\n         These are tab-separated values (TSV) files with a SAM-style header containing a read group sample name,\n         a row specifying the column headers contained in ParameterDecileCollection.ParameterTableColumn,\n         and the corresponding entry rows.\n         The initial result before segmentation smoothing is output to the .modelBegin.cr.param file\n         and the final result after segmentation smoothing is output to the .modelFinal.cr.param file.\n     \u003c/li\u003e\n     \u003cli\u003e\n         Copy-ratio segments file (.cr.seg).\n         This is a tab-separated values (TSV) file with a SAM-style header containing a read group sample name, a sequence dictionary,\n         a row specifying the column headers contained in CopyRatioSegmentCollection.CopyRatioSegmentTableColumn,\n         and the corresponding entry rows.\n         It contains the segments from the .modelFinal.seg file converted to a format suitable for input to CallCopyRatioSegments.\n     \u003c/li\u003e\n     \u003cli\u003e\n         CBS-formatted .cr.igv.seg and .af.igv.seg files (compatible with IGV).\n         These are tab-separated values (TSV) files with CBS-format column headers\n         (see \u003ca href\u003d\"http://software.broadinstitute.org/cancer/software/genepattern/file-formats-guide#CBS\"\u003e\n             http://software.broadinstitute.org/cancer/software/genepattern/file-formats-guide#CBS\u003c/a\u003e)\n         and the corresponding entry rows that can be plotted using IGV (see\n         \u003ca href\u003d\"https://software.broadinstitute.org/software/igv/SEG\"\u003e\n             https://software.broadinstitute.org/software/igv/SEG\u003c/a\u003e).\n         The posterior medians of the log2 copy ratio and minor-allele fraction are given in the SEGMENT_MEAN\n         columns in the .cr.igv.seg and .af.igv.seg files, respectively.\n     \u003c/li\u003e\n     \u003cli\u003e\n         (Optional) Allelic-counts file containing the counts at sites genotyped as heterozygous in the case sample (.hets.tsv).\n         This is a tab-separated values (TSV) file with a SAM-style header containing a read group sample name, a sequence dictionary,\n         a row specifying the column headers contained in AllelicCountCollection.AllelicCountTableColumn,\n         and the corresponding entry rows.\n         This is only output if allelic counts are provided as input.\n     \u003c/li\u003e\n     \u003cli\u003e\n         (Optional) Allelic-counts file containing the counts at sites genotyped as heterozygous in the matched-normal sample (.hets.normal.tsv).\n         This is a tab-separated values (TSV) file with a SAM-style header containing a read group sample name, a sequence dictionary,\n         a row specifying the column headers contained in AllelicCountCollection.AllelicCountTableColumn,\n         and the corresponding entry rows.\n         This is only output if matched-normal allelic counts are provided as input.\n     \u003c/li\u003e\n \u003c/ul\u003e\n\n \u003ch3\u003eUsage examples\u003c/h3\u003e\n\n \u003cpre\u003e\n     gatk ModelSegments \\\n          --denoised-copy-ratios tumor.denoisedCR.tsv \\\n          --allelic-counts tumor.allelicCounts.tsv \\\n          --normal-allelic-counts normal.allelicCounts.tsv \\\n          --output-prefix tumor \\\n          -O output_dir\n \u003c/pre\u003e\n\n \u003cpre\u003e\n     gatk ModelSegments \\\n          --denoised-copy-ratios normal.denoisedCR.tsv \\\n          --allelic-counts normal.allelicCounts.tsv \\\n          --output-prefix normal \\\n          -O output_dir\n \u003c/pre\u003e\n\n \u003cpre\u003e\n     gatk ModelSegments \\\n          --allelic-counts tumor.allelicCounts.tsv \\\n          --normal-allelic-counts normal.allelicCounts.tsv \\\n          --output-prefix tumor \\\n          -O output_dir\n \u003c/pre\u003e\n\n \u003cpre\u003e\n     gatk ModelSegments \\\n          --denoised-copy-ratios normal.denoisedCR.tsv \\\n          --output-prefix normal \\\n          -O output_dir\n \u003c/pre\u003e\n\n \u003cpre\u003e\n     gatk ModelSegments \\\n          --allelic-counts tumor.allelicCounts.tsv \\\n          --output-prefix tumor \\\n          -O output_dir\n \u003c/pre\u003e\n\n \u003ch2\u003eMultisample Mode (ADVANCED / EXPERIMENTAL)\u003c/h2\u003e\n\n Multisample mode is activated when inputs for more than one case sample are specified via the\n denoised-copy-ratios and/or allelic-counts arguments.  In this mode, ModelSegments\n finds common segments across multiple case samples using denoised copy ratios and allelic counts.\n This segmentation can be used as input to subsequent, individual runs of ModelSegments\n on each of the case samples.\n\n \u003cp\u003e\n     Possible data inputs are: 1) denoised copy ratios for the case samples, 2) allelic counts for the case samples,\n     and 3) allelic counts for a matched-normal sample.  All available inputs will be used to to perform\n     segmentation.\n \u003c/p\u003e\n\n \u003cp\u003e\n     As in single-sample mode, the first step is to genotype heterozygous sites.  If allelic counts from\n     a matched normal are available, heterozygous sites in all samples are defined using the normal, as usual;\n     otherwise, each case sample is genotyped individually.  The intersection of heterozygous sites across\n     case samples after filtering on total count and overlap with available copy-ratio intervals is then used for\n     segmentation.  (When the matched normal is available, this intersection is inconsequential if\n     minimum-total-allele-count-case is appropriately set to zero.  As in single-sample mode,\n     determining sites with loss of heterozygosity in high purity case samples will be difficult if the\n     matched normal is not available.)\n \u003c/p\u003e\n\n \u003cp\u003e\n     Next, we jointly segment, if available, the denoised copy ratios and the alternate-allele fractions at the\n     genotyped heterozygous sites across all case samples (which can include the matched normal, if desired).\n     The same caveats discussed above also apply to segmentation in multisample mode; as in single-sample mode,\n     segmentation parameters should be tuned appropriately for each analysis.  Moreover, parameters may also need\n     to be tuned as a function of the number of samples used.\n \u003c/p\u003e\n\n \u003cp\u003e\n     The final output of multisample mode is a Picard interval-list file specifying the joint segmentation.\n     This can be provided to subsequent, individual runs of ModelSegments via the segments argument\n     to perform modeling for each of the case samples; the segmentation step will be skipped in these runs.\n \u003c/p\u003e\n\n \u003cp\u003e\n     Note that the genotyping step will be repeated in these runs, so filters identical to those used in the\n     multisample-mode run should be used.  If allelic counts from a matched normal are available, the resulting set of\n     heterozygous sites used for modeling in these runs should then be identical to that used for segmentation in\n     the multisample-mode run if minimum-total-allele-count-case is appropriately set to zero for all runs.\n     (However, if this is set to a non-zero value or if no matched normal is available, because the intersection\n     of heterozygous sites across samples performed in the multisample-mode run cannot be replicated in the\n     single-sample mode runs, this may ultimately yield sets of sites for modeling that differ across samples.)\n \u003c/p\u003e\n\n \u003cp\u003e\n     See below for usage examples illustrating a run in multisample mode followed by multiple runs in single-sample mode.\n \u003c/p\u003e\n\n \u003ch3\u003eInputs\u003c/h3\u003e\n\n \u003cul\u003e\n     \u003cli\u003e\n         (Optional) List of more than one denoised-copy-ratios files from DenoiseReadCounts.\n         If a list of allelic counts is not provided, then this is required.\n         If a list of allelic counts is also provided, then sample order must match across both lists.\n     \u003c/li\u003e\n     \u003cli\u003e\n         (Optional) List of more than one allelic-counts files from CollectAllelicCounts.\n         If a list of denoised copy ratios is not provided, then this is required.\n         If a list of denoised copy ratios is also provided, then sample order must match across both lists.\n     \u003c/li\u003e\n     \u003cli\u003e\n         (Optional) Matched-normal allelic-counts file from CollectAllelicCounts.\n         This can only be provided if a list of allelic counts for the case samples are also provided.\n     \u003c/li\u003e\n \u003c/ul\u003e\n\n \u003ch3\u003eOutputs\u003c/h3\u003e\n\n \u003cul\u003e\n     \u003cli\u003e\n         Multisample-segments .interval_list Picard interval-list file.\n         This segmentation can be used as input to subsequent, individual runs of ModelSegments on each of\n         the case samples.\n     \u003c/li\u003e\n \u003c/ul\u003e\n\n \u003ch3\u003eUsage examples\u003c/h3\u003e\n\n \u003ch4\u003eMultisample-mode run (outputs multisample-segmentation.interval_list containing the multisample segmentation) \u003c/h4\u003e\n\n \u003cpre\u003e\n     gatk ModelSegments \\\n          --denoised-copy-ratios normal.denoisedCR.tsv \\\n          --denoised-copy-ratios tumor-1.denoisedCR.tsv \\\n          ...\n          --denoised-copy-ratios tumor-N.denoisedCR.tsv \\\n          --allelic-counts normal.allelicCounts.tsv \\\n          --allelic-counts tumor-1.allelicCounts.tsv \\\n          ...\n          --allelic-counts tumor-N.allelicCounts.tsv \\\n          --normal-allelic-counts normal.allelicCounts.tsv \\\n          --output-prefix multisample-segmentation\n          -O output_dir\n \u003c/pre\u003e\n\n \u003ch4\u003eSingle-sample mode runs (segmentation is taken from multisample-segmentation.interval_list,\n so the segmentation step is skipped in each run)\u003c/h4\u003e\n\n \u003cpre\u003e\n     gatk ModelSegments \\\n          --segments multisample-segmentation.interval_list\n          --denoised-copy-ratios normal.denoisedCR.tsv \\\n          --allelic-counts normal.allelicCounts.tsv \\\n          --normal-allelic-counts normal.allelicCounts.tsv \\\n          --output-prefix normal\n          -O output_dir\n \u003c/pre\u003e\n\n \u003cpre\u003e\n     gatk ModelSegments \\\n          --segments multisample-segmentation.interval_list\n          --denoised-copy-ratios tumor-1.denoisedCR.tsv \\\n          --allelic-counts tumor-1.allelicCounts.tsv \\\n          --normal-allelic-counts normal.allelicCounts.tsv \\\n          --output-prefix tumor-1\n          -O output_dir\n \u003c/pre\u003e\n\n \u003cpre\u003e\n     ...\n \u003c/pre\u003e\n\n \u003cpre\u003e\n     gatk ModelSegments \\\n          --segments multisample-segmentation.interval_list\n          --denoised-copy-ratios tumor-N.denoisedCR.tsv \\\n          --allelic-counts tumor-N.allelicCounts.tsv \\\n          --normal-allelic-counts normal.allelicCounts.tsv \\\n          --output-prefix tumor-N\n          -O output_dir\n \u003c/pre\u003e",
  "name": "ModelSegments",
  "group": "Copy Number Variant Discovery",
  "beta": false,
  "experimental": false
}