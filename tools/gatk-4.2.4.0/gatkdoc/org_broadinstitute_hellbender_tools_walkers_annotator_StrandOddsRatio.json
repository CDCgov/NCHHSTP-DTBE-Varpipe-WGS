{
  "summary": "Strand bias estimated by the symmetric odds ratio test (SOR)",
  "arguments": [],
  "description": "Strand bias estimated by the Symmetric Odds Ratio test\n\n \u003cp\u003eStrand bias is a type of sequencing bias in which one DNA strand is favored over the other, which can result in\n incorrect evaluation of the amount of evidence observed for one allele vs. the other. The StrandOddsRatio annotation\n is one of several methods that aims to evaluate whether there is strand bias in the data. It is an updated form of\n the \u003ca href\u003d\"https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org_broadinstitute_hellbender_tools_walkers_annotator_FisherStrand.php\"\u003eFisher Strand Test\u003c/a\u003e\n that is better at taking into account large amounts of data in high coverage situations. It is used to determine if\n there is strand bias between forward and reverse strands for the reference or alternate allele(s).\u003c/p\u003e\n\n \u003ch3\u003eStatistical notes\u003c/h3\u003e\n\n \u003cp\u003eThe following 2x2 contingency table gives the notation for allele support and strand orientation.\u003c/p\u003e\n\n \u003ctable\u003e\n \u003ctr\u003e\u003cth\u003e\u0026nbsp;\u003c/th\u003e\u003cth\u003e+ strand\u0026nbsp;\u0026nbsp;\u0026nbsp;\u003c/th\u003e\u003cth\u003e- strand\u0026nbsp;\u0026nbsp;\u0026nbsp;\u003c/th\u003e\u003c/tr\u003e\n \u003ctr\u003e\u003cth\u003eREF\u0026nbsp;\u0026nbsp;\u0026nbsp;\u003c/th\u003e\u003ctd\u003eX[0][0]\u003c/td\u003e\u003ctd\u003eX[0][1]\u003c/td\u003e\u003c/tr\u003e\n \u003ctr\u003e\u003cth\u003eALT\u0026nbsp;\u0026nbsp;\u0026nbsp;\u003c/th\u003e\u003ctd\u003eX[1][0]\u003c/td\u003e\u003ctd\u003eX[1][1]\u003c/td\u003e\u003c/tr\u003e\n \u003c/table\u003e\n\n \u003cp\u003eWe can then represent the Odds Ratios with the equation:\u003c/p\u003e\n\n \u003cimg src\u003d\"http://latex.codecogs.com/svg.latex?R \u003d \\frac{X[0][0] * X[1][1]}{X[0][1] * X[1][0]}\" border\u003d\"0\"/\u003e\n\n \u003cp\u003eand its inverse:\u003c/p\u003e\n\n \u003cimg src\u003d\"http://latex.codecogs.com/svg.latex?\\frac{1}{R} \u003d \\frac{X[0][1] * X[1][0]}{X[0][0] * X[1][1]}\" border\u003d\"0\"/\u003e\n\n \u003cp\u003eThe sum R + 1/R is used to detect a difference in strand bias for REF and for ALT. The sum makes it symmetric.\n A high value is indicative of large difference where one entry is very small compared to the others. A scale factor\n of refRatio/altRatio where\u003c/p\u003e\n\n \u003cimg src\u003d\"http://latex.codecogs.com/svg.latex?refRatio \u003d \\frac{min(X[0][0], X[0][1])}{max(X[0][0], X[0][1])}\" border\u003d\"0\"/\u003e\n\n \u003cp\u003eand \u003c/p\u003e\n\n \u003cimg src\u003d\"http://latex.codecogs.com/svg.latex?altRatio \u003d \\frac{min(X[1][0], X[1][1])}{max(X[1][0], X[1][1])}\" border\u003d\"0\"/\u003e\n\n \u003cp\u003eensures that the annotation value is large only. The final SOR annotation is given in natural log space.\u003c/p\u003e\n\n \u003cp\u003eSee the \u003ca href\u003d\"http://www.broadinstitute.org/gatk/guide/article?id\u003d4732\"\u003emethod document on statistical tests\u003c/a\u003e\n for a more detailed explanation of this statistical test.\u003c/p\u003e\n\n \u003ch3\u003eExample calculation\u003c/h3\u003e\n\n \u003cp\u003eHere is a variant record where SOR is 0.592.\u003c/p\u003e\n\n \u003cpre\u003e\n     AC\u003d78;AF\u003d2.92135e-02;AN\u003d2670;DP\u003d31492;FS\u003d48.628;MQ\u003d58.02;MQRankSum\u003d-2.02400e+00;MQ_DP\u003d3209;QD\u003d3.03; \\\n     ReadPosRankSum\u003d-1.66500e-01;SB_TABLE\u003d1450,345,160,212;SOR\u003d0.592;VarDP\u003d2167\n \u003c/pre\u003e\n\n \u003cp\u003eRead support shows some strand bias for the reference allele but not\n the alternate allele. The SB_TABLE annotation (a non-GATK annotation) indicates 1450 reference alleles on the forward strand, 345\n reference alleles on the reverse strand, 160 alternate alleles on the forward strand and 212 alternate alleles on\n the reverse strand. The tool uses these counts towards calculating SOR. To avoid multiplying or dividing by zero\n values, the tool adds one to each count.\u003c/p\u003e\n\n \u003cpre\u003e\n refFw \u003d 1450 + 1 \u003d 1451\n refRv \u003d 345 + 1 \u003d 346\n altFw \u003d 160 + 1 \u003d 161\n altRv \u003d 212 + 1 \u003d 213\n \u003c/pre\u003e\n\n \u003cp\u003eCalculate SOR with the following.\u003c/p\u003e\n\n \u003cp\u003e\u003cimg src\u003d\"http://latex.codecogs.com/svg.latex?SOR \u003d ln(symmetricalRatio) + ln(refRatio) - ln(altRatio)\" border\u003d\"0\"/\u003e\u003c/p\u003e\n\n \u003cp\u003ewhere\u003c/p\u003e\n\n \u003cp\u003e\u003cimg src\u003d\"http://latex.codecogs.com/svg.latex?symmetricalRatio \u003d R + \\frac{1}{R}\" border\u003d\"0\"/\u003e\u003c/p\u003e\n \u003cp\u003e\u003cimg src\u003d\"http://latex.codecogs.com/svg.latex?R \u003d \\frac{(\\frac{refFw}{refRv})}{(\\frac{altFw}{altRv})} \u003d \\frac{(refFw*altRv)}{(altFw*refRv)}\" border\u003d\"0\"/\u003e\u003c/p\u003e\n\n \u003cp\u003e\u003cimg src\u003d\"http://latex.codecogs.com/svg.latex?refRatio \u003d\\frac{(smaller\\;of\\;refFw\\;and\\;refRv)}{(larger\\;of\\;refFw\\;and\\;refRv)}\" border\u003d\"0\"/\u003e\u003c/p\u003e\n\n \u003cp\u003eand\u003c/p\u003e\n\n \u003cp\u003e\u003cimg src\u003d\"http://latex.codecogs.com/svg.latex?altRatio \u003d \\frac{(smaller\\;of\\;altFw\\;and\\;altRv)}{(larger\\;of\\;altFw\\;and\\;altRv)}\" border\u003d\"0\"/\u003e\u003c/p\u003e\n\n \u003cp\u003eFill out the component equations with the example counts to calculate SOR.\u003c/p\u003e\n\n \u003cpre\u003e\n symmetricalRatio  \u003d (1451*213)/(161*346) + (161*346)/(1451*213) \u003d 5.7284\n refRatio \u003d 346/1451 \u003d 0.2385\n altRatio \u003d 161/213 \u003d 0.7559\n SOR \u003d ln(5.7284) + ln(0.2385) - ln(0.7559) \u003d 1.7454427755 + (-1.433) - (-0.2798) \u003d 0.592\n \u003c/pre\u003e\n\n \u003ch3\u003eRelated annotations\u003c/h3\u003e\n \u003cul\u003e\n     \u003cli\u003e\u003cb\u003eAS_StrandOddsRatio\u003c/b\u003e allele-specific strand bias estimated by the symmetric odds ratio test.\u003c/li\u003e\n     \u003cli\u003e\u003cb\u003eStrandBiasBySample\u003c/b\u003e outputs counts of read depth per allele for each strand orientation.\u003c/li\u003e\n     \u003cli\u003e\u003cb\u003eFisherStrand\u003c/b\u003e uses Fisher\u0027s Exact Test to evaluate strand bias.\u003c/li\u003e\n \u003c/ul\u003e",
  "name": "StrandOddsRatio",
  "group": "Variant Annotations",
  "beta": false,
  "experimental": false
}